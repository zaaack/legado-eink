!function(){"use strict";!function(n){if(!n||"undefined"==typeof window)return;const t=document.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=n,document.head.appendChild(t)}("body {\n  margin: 0;\n  padding: 0;\n  font-size: 20px;\n}\n\n.books {\n  list-style: none;\n  padding: 0;\n  margin: 0;\n}\n.books li {\n  padding: 10px;\n  font-size: 25px;\n  border-bottom: 1px solid #aaa;\n}\n\n#reader {\n  padding: 10px;\n  padding-bottom: 50px;\n  padding-top: 30px;\n}\n#reader .header {\n  position: fixed;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 30px;\n  line-height: 30px;\n  font-size: 14px;\n  color: #999;\n  background-color: #fff;\n}\nhtml[data-theme=dark] #reader .header {\n  color: #ccc;\n  background-color: #000;\n}\n\nhtml[data-theme=dark] #reader {\n  background-color: #000;\n  color: #fff;\n}\n\n#reader .title {\n  font-size: 30px;\n  font-weight: bold;\n}\n#reader .content {\n  font-size: 24px;\n  white-space: pre-line;\n}\n#reader .buttons {\n  height: 40px;\n  line-height: 40px;\n  width: 100%;\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  background-color: #fff;\n  overflow: hidden;\n}\nhtml[data-theme=dark] #reader .buttons {\n  background-color: #000;\n}\n\n#reader .buttons div {\n  width: 33%;\n  float: left;\n  text-align: center;\n  border: 1px solid #000;\n}\nhtml[data-theme=dark] #reader .buttons div {\n  border-color: #fff;\n}");var n="http://192.168.31.246:1122";var t=0,e=!1;function o(o,a,r,d){if(!e)return e=!0,t=r,$.when($.getJSON("".concat(n,"/getBookContent"),{url:o.bookUrl,index:r}).then((function(t){return $("#reader .title").text(a[r].title),$("#reader .content").text(t.data),"prev"===d?window.scrollTo(0,document.body.scrollHeight):window.scrollTo(0,0),$.ajax({url:"".concat(n,"/saveBookProgress"),data:JSON.stringify({author:o.author,durChapterIndex:r,durChapterPos:"prev"===d?t.data.length:0,durChapterTime:1684307625485,durChapterTitle:a[r].title,name:o.name}),method:"post",dataType:"json",contentType:"application/json"})})).always((function(){e=!1})))}!function e(){function a(){localStorage.base=window.prompt("设置服务地址"),e()}var r=function(){return"设置主题(当前:".concat("dark"===localStorage.theme?"黑":"白",")")};localStorage.theme||(localStorage.theme="dark"),$.getJSON("".concat(n,"/getBookshelf")).then((function(e){$('<div>\n    <ul class="books">\n    '.concat(e.data.map((function(n,t){return'<li data-book-index="'.concat(t,'">').concat(n.name,"</li>")})).join(""),'\n    </ul>\n    <button class="setBase">设置服务地址</button>\n    <button class="setTheme">').concat(r(),"</button>\n    </div>")).appendTo($("#root").html("")).on("click","li",(function(a){var r=e.data[+$(a.target).data("book-index")];console.log(r),function(e){var a=window.innerHeight-50-30-30;$.when($.getJSON("".concat(n,"/getChapterList"),{url:e.bookUrl}),$.getJSON("".concat(n,"/getBookContent"),{url:e.bookUrl,index:e.durChapterIndex})).then((function(n,r){var d=n[0],i=r[0];t=e.durChapterIndex;var c=d.data[t];$('<div id="reader">\n      <div class="header">'.concat(c.title,'</div>\n      <div class="title">').concat(c.title,'</div>\n      <div class="content">').concat(i.data,'</div>\n      <div class="buttons">\n        <div class="prev">上一页</div>\n        <div class="cat">目录</div>\n        <div class="next"=>下一页</div>\n      </div>\n    </div>')).appendTo($("#root").html("")).on("click",".prev",(function(n){window.scrollY<=1?t-1<0?alert("已经是第一章了"):o(e,d.data,t-1,"prev"):window.scrollBy(0,-a)})).on("click",".next",(function(n){window.scrollY>=document.body.scrollHeight-window.innerHeight-1?t+1>=e.totalChapterNum?alert("已经是最后一章了"):o(e,d.data,t+1,"next"):window.scrollBy(0,a)}))}))}(r)})).on("click",".setBase",a).on("click",".setTheme",(function(n){"dark"===localStorage.theme?localStorage.theme="light":localStorage.theme="dark",$(n.target).html(r()),$("html").data("theme",localStorage.theme)}))})).fail((function(n){console.error(n),$('<button class="setBase">设置服务地址</button>').appendTo("#root").on("click",a)})),document.addEventListener("keydown",(function(n){["AudioVolumeDown","ArrowRight","ArrowDown"].indexOf(n.key)>=0?$(".next").trigger("click"):["AudioVolumeUp","ArrowLeft","ArrowUp"].indexOf(n.key)>=0&&$(".prev").trigger("click")}))}()}();
//# sourceMappingURL=bundle.8c07f7.js.map
